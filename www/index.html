<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover"
  />
  <meta name="format-detection" content="telephone=no" />
  <meta name="color-scheme" content="dark light" />

  <!-- Content Security Policy for Cordova -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self' data: https: gap:;
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com https://esm.sh;
    style-src 'self' 'unsafe-inline';
    img-src 'self' data: blob: https:;
    media-src 'self' data: blob:;
    font-src 'self' data:;
    connect-src 'self' https://czfrylnwekgvnpzklohj.supabase.co https://cdn.jsdelivr.net https://unpkg.com https://esm.sh wss://czfrylnwekgvnpzklohj.supabase.co;
  " />

  <title>Raining Bud</title>

  <!-- CSS en chemin relatif -->
  <link rel="stylesheet" href="assets/style.css" />

</head>
<body>
  <div class="wrap">
    <div id="gameWrapper">
      <div id="bgLayer" aria-hidden="true"></div>
      <canvas
        id="gameCanvas"
        width="360"
        height="640"
        aria-label="Salt Droppee canvas"
      ></canvas>

      <!-- HUD overlay -->
      <div id="hud" aria-label="Game HUD">
        <!-- Gauche : SCORE sur 2 lignes -->
        <div class="hud-left">
          <div class="hud-score-label">SCORE</div>
          <div class="hud-score-value" id="hudScore">0</div>
        </div>

        <!-- Centre : Combo + mini-jauge -->
        <div class="hud-center">
          <div class="combo-chip" id="hudComboChip">
            <span class="combo-icon">âš¡</span>
            <span class="combo-mult" id="hudComboMult">x1.0</span>
            <span class="combo-streak" id="hudComboStreak">(0)</span>
          </div>
          <div class="combo-bar">
            <div class="combo-bar-fill" id="hudComboFill"></div>
          </div>
        </div>

        <!-- Droite : 2 lignes (Vies / Temps) -->
        <div class="hud-right" id="hudRight">
          <div class="hud-legend-boost" id="hudLegendBoost">
            <div class="hud-legend-boost-label">BOOST</div>
            <div class="hud-legend-boost-value" id="hudLegendBoostValue">Lvl 1</div>
          </div>
          <div class="hud-right-stats">
            <div class="hud-lives" id="hudLives">â™¥â™¥â™¥</div>
            <div class="hud-time" id="hudTime">60s</div>
          </div>
        </div>
      </div>

      <!-- Inter-level overlay (cachÃ© par dÃ©faut) -->
      <div id="interLevelScreen" class="overlay inter-level-screen" aria-hidden="true">
        <div class="panel panel-shell inter-level-panel" role="dialog" aria-modal="true" aria-labelledby="interTitle">
          <div class="panel-header">
            <h1 id="interTitle">Niveau terminÃ© ðŸŽ‰</h1>
          </div>

          <div class="panel-grid">
            <section class="panel-section panel-card inter-level-summary">
              <p id="interScore" class="panel-subline">Score : 0000</p>
            </section>
          </div>

          <div class="panel-footer">
            <div class="btnrow panel-actions inter-level-buttons">
              <button id="btnNextLevel" type="button">Niveau suivant</button>
              <button id="btnSaveQuit" type="button">Sauvegarder &amp; Quitter</button>
              <button type="button" class="btn-settings" data-action="open-settings">ParamÃ¨tres</button>
            </div>
          </div>
        </div>
      </div>

      <div id="legendResultScreen" class="overlay legend-result-screen" aria-hidden="true">
        <div class="panel panel-shell legend-result-panel" role="dialog" aria-modal="true" aria-labelledby="legendTitle">
          <div class="panel-header">
            <h1 id="legendTitle">Mode LÃ©gende</h1>
          </div>

          <div class="panel-grid">
            <section class="panel-section panel-card legend-result-message">
              <p id="legendMessage" class="panel-subline">FÃ©licitations, votre score est de 0.</p>
            </section>
          </div>

          <div class="panel-footer">
            <div class="btnrow panel-actions legend-buttons">
              <button id="legendHomeButton" type="button">Retour Ã  lâ€™accueil</button>
              <button id="legendRetryButton" type="button">Recommencer</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Overlays dynamiques (menu, pause, fin) -->
      <div id="overlay" class="overlay" aria-live="polite" aria-hidden="true"></div>
    </div>
  </div>

  <!-- Cordova.js - auto-injected by Cordova CLI during build -->
  <script src="cordova.js"></script>

  <!-- JS du jeu en chemin relatif -->
  <script src="lib/gsap/gsap.min.js"></script>
  <script src="js/soundManager.js"></script>
  <script type="module" src="js/dataService.js"></script>
  <script type="module" src="js/authController.js"></script>
  <script type="module" src="js/progressController.js"></script>
  <script type="module" src="js/scoreController.js"></script>
  <script type="module" src="js/referralController.js"></script>
  <script src="js/config.js" defer></script>
  <script src="js/utils.js" defer></script>
  <script src="js/game-math.js" defer></script>
  <script src="js/canvas.js" defer></script>
  <script src="js/input.js" defer></script>
  <script src="js/render.js" defer></script>
  <script src="js/levels.js" defer></script>
  <script src="js/audio.js" defer></script>
  <script src="js/progress.js" defer></script>
  <script src="js/ui-core.js" defer></script>
  <script src="js/ui-overlays.js" defer></script>
  <script src="js/ui-panels.js" defer></script>
  <script src="js/ui-account.js" defer></script>
  <script src="js/entities/wallet.js" defer></script>
  <script src="js/entities/arm.js" defer></script>
  <script src="js/entities/fallingItem.js" defer></script>
  <script src="js/gameRuntime.js" defer></script>
  <script src="js/nav.js" defer></script>
  <script src="js/game-session.js" defer></script>
  <script src="js/main.js" defer></script>

</body>
</html>
