<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="color-scheme" content="dark light" />
  <title>Salt Droppee</title>

  <!-- CSS en chemin relatif -->
  <link rel="stylesheet" href="assets/style.css" />

  <!-- Cordova: chargement conditionnel, jamais en dur -->
  <script>
    if (window.cordova) {
      document.write('<script src="cordova.js"><\\/script>');
    }
  </script>

</head>
<body>
  <div class="wrap">
    <div id="gameWrapper">
      <div id="bgLayer" aria-hidden="true"></div>
      <canvas
        id="gameCanvas"
        width="360"
        height="640"
        aria-label="Salt Droppee canvas"
      ></canvas>

      <!-- HUD overlay -->
      <div id="hud" aria-label="Game HUD">
        <!-- Gauche : SCORE sur 2 lignes -->
        <div class="hud-left">
          <div class="hud-score-label">SCORE</div>
          <div class="hud-score-value" id="hudScore">0</div>
        </div>

        <!-- Centre : Combo + mini-jauge -->
        <div class="hud-center">
          <div class="combo-chip" id="hudComboChip">
            <span class="combo-icon">⚡</span>
            <span class="combo-mult" id="hudComboMult">x1.0</span>
            <span class="combo-streak" id="hudComboStreak">(0)</span>
          </div>
          <div class="combo-bar">
            <div class="combo-bar-fill" id="hudComboFill"></div>
          </div>
        </div>

        <!-- Droite : 2 lignes (Vies / Temps) -->
        <div class="hud-right" id="hudRight">
          <div class="hud-lives" id="hudLives">♥♥♥</div>
          <div class="hud-time" id="hudTime">60s</div>
        </div>
      </div>

      <!-- Overlays principaux -->
      <div id="title" class="overlay show" aria-hidden="false">
        <div class="panel">
          <h1>Salt Droppee</h1>
          <p>Attrapez les bons tokens, évitez les malus. 75s, 3 vies.</p>
          <div class="actions btnrow">
            <button type="button" data-action="play">Jouer</button>
            <button type="button" class="btn-settings" data-action="open-settings">Paramètres</button>
            <button type="button" id="btnLB">Leaderboard local</button>
          </div>
        </div>
      </div>

      <div id="pause" class="overlay" aria-hidden="true">
        <div class="panel">
          <h1>Pause</h1>
          <div class="actions btnrow">
            <button type="button" data-action="resume">Reprendre</button>
            <button type="button" class="btn-settings" data-action="open-settings">Paramètres</button>
            <button type="button" data-action="go-title">Menu</button>
          </div>
        </div>
      </div>

      <div id="interLevel" class="overlay" aria-hidden="true">
        <div class="inter-content" role="dialog" aria-modal="true" aria-labelledby="interTitle">
          <h2 id="interTitle">Niveau terminé !</h2>
          <p id="interScore">Score : 0000</p>
          <div class="actions inter-buttons">
            <button id="btnNextLevel" type="button" data-action="next-level">Niveau suivant</button>
            <button id="btnSaveQuit" type="button" data-action="save-quit">Sauvegarder &amp; Quitter</button>
            <button type="button" class="btn-settings" data-action="open-settings">Paramètres</button>
          </div>
        </div>
      </div>

      <div id="settings" class="overlay" aria-hidden="true">
        <div class="panel">
          <h1>Paramètres</h1>
          <p>
            <label>
              <input type="checkbox" id="sound" /> Son
            </label>
          </p>
          <p>
            <label>
              <input type="checkbox" id="contrast" /> Contraste élevé
            </label>
          </p>
          <p>
            <label>
              <input type="checkbox" id="haptics" /> Vibrations
            </label>
          </p>
          <p>
            Sensibilité:
            <input type="range" id="sens" min="0.5" max="1.5" step="0.05" value="1" />
          </p>
          <div class="actions btnrow">
            <button type="button" class="btn-back" data-action="close-settings">Retour</button>
          </div>
        </div>
      </div>

      <!-- Overlay dynamique générique -->
      <div id="overlay" class="overlay" aria-live="polite" aria-hidden="true"></div>
    </div>
  </div>

  <!-- JS du jeu en chemin relatif -->
  <script src="lib/gsap/gsap.min.js"></script>
  <script src="js/soundManager.js"></script>
  <script src="js/main.js" defer></script>

</body>
</html>
